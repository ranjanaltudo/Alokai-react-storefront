"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const m=require("tabbable"),c=require("@storefront-ui/shared"),l=require("react");var K=(r=>(r.autofocus="autofocus",r.container="container",r))(K||{});const P={trapTabs:!0,activeState:!0,initialFocus:0,initialFocusContainerFallback:!1,arrowKeysOn:!1,arrowKeysLeftRight:!1,arrowKeysUpDown:!1},q=(r,D)=>{const{trapTabs:F,arrowFocusGroupSelector:y,includeContainer:k,activeState:A,initialFocus:o,arrowKeysOn:L,arrowKeysLeftRight:h,arrowKeysUpDown:v,initialFocusContainerFallback:x}={...P,...D},[i,S]=l.useState(),[u,b]=l.useState([]),n=({event:e,additionalData:t})=>c.focusPrev({current:i,focusables:u,event:e,...t}),f=({event:e,additionalData:t})=>c.focusNext({current:i,focusables:u,event:e,...t}),d=l.useCallback(e=>{var a;const s=y&&((a=r.current)==null?void 0:a.querySelector(y))?{arrowFocusGroupSelector:y}:{};L&&(e.key==="ArrowLeft"||e.key==="ArrowUp")&&n({additionalData:s}),L&&(e.key==="ArrowRight"||e.key==="ArrowDown")&&f({additionalData:s}),h&&e.key==="ArrowLeft"&&n({additionalData:s}),h&&e.key==="ArrowRight"&&f({additionalData:s}),v&&e.key==="ArrowUp"&&n({additionalData:s}),v&&e.key==="ArrowDown"&&f({additionalData:s}),F&&c.isTab(e)&&f({event:e}),F&&c.isTabAndShift(e)&&n({event:e})},[i]),T=()=>{const e=document.activeElement;S(e)},C=()=>{var e,t;(e=r.current)==null||e.removeEventListener("keydown",d),(t=r.current)==null||t.removeEventListener("focus",T,!0)};l.useEffect(()=>{var e,t,s,a;if(r.current&&A){(e=r.current)==null||e.addEventListener("focus",T,!0),(t=r.current)==null||t.addEventListener("keydown",d);let w=!1;if(b(m.tabbable(r.current,{includeContainer:k})),typeof o=="number")u[o]?(s=u[o])==null||s.focus():(console.error(`There is no element with given index ${o}`),w=!0);else if(o==="autofocus"){const g=u.find(p=>p==null?void 0:p.hasAttribute("autofocus"));g?g.focus():w=!0}(x&&w||o==="container")&&((a=r.current)==null||a.focus())}else b([]),S(void 0);return C},[r.current,A,d]);const N=()=>{r.current&&b(m.tabbable(r.current,{includeContainer:k}))};return{current:i,focusables:u,focusNext:c.focusNext,focusPrev:c.focusPrev,updateFocusableElements:N}};exports.InitialFocusType=K;exports.useTrapFocus=q;
